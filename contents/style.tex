\begin{savequote}[45mm]
\ascii{Do the simplest thing that could possibly work.}
\qauthor{\ascii{- Kent Beck}}
\end{savequote}

\chapter{代码风格} 
\label{ch:physical-design}

\section{开发环境}

\begin{content}

\begin{regulation}
为了防止代码出现可移植性问题，团队使用的操作系统、编译器类型、版本保持一致性
\end{regulation}

\begin{regulation}
团队统一使用相同的\ascii{IDE}，并使用统一的代码模板，保持代码风格的一致性
\end{regulation}

系统中所有的代码看起来就好像是由单独一个值得胜任的人编写的\footnote{\ascii{Agile Software Development, Principles, Patterns, and Practices, Robert C. Martin}}。

\begin{regulation}
团队统一配置\ascii{IDE}使用等宽字体，不允许使用宋体编程
\end{regulation}

如果团队中有人使用宋体编码，会造成团队代码对不齐、缩进混乱的情况。优秀的程序员在写第一行代码前，都会将自己的编译环境、颜色、字体等调整到最佳状态，以便在写代码的时候更友好地、更快捷地反馈所存在的问题，提高工作效率。

\begin{regulation}
团队统一配置\ascii{IDE}的文件编码格式
\end{regulation}

例如统一为\ascii{UTF-8}，或\ascii{GBK, GB2312}，不允许使用不同的编码格式，否则中文可能会出现乱码的现象。

\begin{regulation}
团队统一配置\ascii{IDE}的\ascii{TAB}为相同数目的空格，坚决抵制使用\ascii{TAB}对齐代码\footnote{\ascii{TAB}一般配置为2或4个空格，所有的编辑器都提供了类似的配置接口}
\end{regulation}

因各种编辑器解释\ascii{TAB}的长度存在不一致，如果使用\ascii{TAB}对齐代码，可能会使代码缩进混乱不堪。

\end{content}

\section{代码风格}

\begin{content}

\begin{regulation}
团队应该保持一致的命名、缩进、空格、空行、断行的代码风格
\end{regulation}

业界存在多种经典的代码风格，各自都拥有独特的优势，团队应该选择并保持其中一种代码风格。

\begin{enum}
  \eitem{\ascii{K\&R}}
  \eitem{\ascii{BSD/Allman}}
  \eitem{\ascii{GNU}}
  \eitem{\ascii{Whitesmiths}}
\end{enum}

统一代码风格并非难事，团队发布统一的\ascii{IDE}代码模板，及其定制一个方便的格式化快捷键即可解决所有对齐、缩进、空格、断行等问题。

\begin{regulation}
程序实体之间有且仅有一行空行区分
\end{regulation}

函数之间的空行，能够帮组我们快速定位函数的始末的准确位置；甚至在函数内部，将逻辑相关的代码放在一起也同样具有意义，它能够帮组我们更好地理解代码块的语义。

超过一行的空行完全没有必要，部分粗心的程序员在处理这些细节时总存在着或多或少的问题，团队应该杜绝这样的情况发生。

\begin{regulation}
每个文件末尾都应该有且仅有一行空行
\end{regulation}

如果使用\ascii{Eclipse}，在创建新文件时自动地在文件末添加一行空行；但诸如\ascii{Visual C++}等情况下，则需要程序员在文件末自行手动地添加一行空行。

这样做可以最大化地实现代码可移植性，避免某些编译器因缺少空行而报告警告信息。

\begin{regulation}
每一行的代码或注释不得超过\ascii{80}列，否则将其拆分为若干行，并保持适当缩进，保证排版整洁漂亮
\end{regulation}

长表达式、长语句或多或少都存在重复，此时往往是函数提取、概念整合的最佳时机，缩短长表达式、长语句可以极大地缩短阅读代码的时间，并改善代码的可读性。

\begin{regulation}
注释符号与注释内容之间要用一个空格分割
\end{regulation}

当注释内容与注释符号之间没有空格，尤其是中文注释，导致部分编译器词法分析错误，导致编译失败\footnote{笔者曾无数次被此类低级错误问题所绊脚过。}。

反例：
\begin{leftbar}
\begin{c++}
/*multi-line comment*/
//sigle-line comment
\end{c++}
\end{leftbar}

正例：
\begin{leftbar}
\begin{c++}
/* multi-line comment */
// single-line comment
\end{c++}
\end{leftbar}

\end{content}
