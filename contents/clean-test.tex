\begin{savequote}[45mm]
\ascii{There are two ways of constructing a software design. One way is to make it so simple that there are obviously no deficiencies. And the other way is to make it so complicated that there are no obvious deficiencies.}
\qauthor{\ascii{- C.A.R. Hoare}}
\end{savequote}

\chapter{整洁测试}
\label{ch:clean-test}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{TDD}

\begin{content}

\begin{regulation}
\ascii{TDD}遵循三定律
\end{regulation}

\begin{enum}
  \eitem{在编写不能通过的测试前，不可编写生产代码}
  \eitem{只可编写刚好无法通过的测试，不能编译也算不通过}
  \eitem{只可编写刚好足以通过当前失败测试的生产代码}
\end{enum}

关于测试驱动请参考\ascii{Kent Beck的著作《Test-Driven Development, by example》}。

\begin{regulation}
测试名称遵循\ascii{Given-When-Then}
\end{regulation}

这是流行的\ascii{BDD，行为驱动测试}命名规范，当阅读测试用例时，或当测试失败时，这样的命名风格非常有利于行为的描述。

摒弃原始的\ascii{TestXXX}的风格吧，因为它不能清晰表达\ascii{TDD}的意图。

\begin{regulation}
每一个测试一个概念
\end{regulation}

这是\ascii{SRP}在测试用例中的体现，当测试用例失败的时候，能够清晰地知道测试失败的原因。

一个概念往往只会有一个断言来描述，出现数目众多的断言往往违背了此规则。

\begin{regulation}
将具有相同测试环境的用例放在同一个测试套件中
\end{regulation}

将构造测试环境及清理测试环境的代码分别放在\ascii{Setup}及\ascii{Teardown}中，可以消除重复的代码，实现代码的最大可复用性。

\begin{regulation}
测试应该像文档一样清晰
\end{regulation}

测试用例是理解系统行为的最佳途径，也是最实时、最权威的文档。

\begin{regulation}
测试更应该是像一个例子
\end{regulation}

测试不仅仅为了测试而测试，更重要的是对系统行为的描述。

\begin{regulation}
测试用例中不应该存在复杂的循环、条件控制语句
\end{regulation}

测试用例堆可读性的要求非常高，如果出现大量的循环、条件控制语句，将大大地损害了用例的可读性。一般地，测试用例应该是有若干条陈述句所组成，越简单越好。

\begin{regulation}
设计面向特定领域的测试语言是值得的
\end{regulation}

根据领域问题，设计特定领域描述语言\ascii{DSL}，将改善用例的可读性和维护性。

\end{content}
